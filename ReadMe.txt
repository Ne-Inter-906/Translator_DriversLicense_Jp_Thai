# Translator_DriversLicense_Jp_Thai

#--japanese-------------------------------------------------------------------------------------------------------------------------------
## 概要
   日本の運転免許筆記試験の練習問題や模擬試験を外国語（現在はタイ語のみ）
   にNLLBを使用して自動翻訳するためのツールです
   
   翻訳した後、さらにLaBSEを使用して翻訳精度のチェックを行えます。
   
   > [!IMPORTANT]
   > **翻訳元のデータについて**
   > 著作権保護の観点から、翻訳元となる日本語の問題データは同梱していません。ご自身で用意したExcelファイルを指定の場所に配置して使用してください。
   
   ローカル環境にHuggingFaceから翻訳用AIをダウンロードして実行します、
   そのためNvidia GeForceなど、pytorchで使用可能なグラボを搭載したPCの使用が前提となります
   CPUのみでも実行は可能ですが処理速度が大幅に遅くなります
   なおローカルAIの類はライブラリインストールの後、初回実行時にDLされます、よって初回のみ以降よりも長い時間が必要になります

   ※ライセンスに関する注意:
      本ツールのプログラムコードはMITライセンスですが、使用しているAIモデル（NLLB-200, LaBSE）の利用に関しては、
      それぞれのモデルのライセンス（Meta, Google）に従ってください。

## 動作確認済環境
   OS: win32
   Python: 3.12.0
   PyTorch version: 2.9.1+cu130
   CUDA available: True
   　　　Version: 13.0
   GPU: NVIDIA GeForce RTX 5060
   CustomTkinter version: 5.2.2

## セットアップ
   1.リポジトリをクローンまたはダウンロードします。
   2.ライブラリのインストール
      pip install -r requirements.txt


## 起動
   Tr_Gui.pyから実行します

## translate mode
   AI(METAのNLLB)で日本語からタイ語へ翻訳を行います
   翻訳したいデータを以下の構成で配置してください。

      配置先: ファイル選択ボタンを押して自身で用意したExcelファイルを選んでください。
      注：（ファイルの内容はtemplates/Driver'sLicense_MockTest.xlsx と同じセル構成にしてください。
            構成が変わっていると正常に動作しません。）

      B列: 問題文（日本語）

      F列: 解説文（日本語）

   ※1行目はヘッダーとして扱い、2行目からデータを読み込みます。
     
   問題文のみ、解説文のみ、もしくはその両方、そして全行一気に翻訳するか、行数を指定して翻訳が可能です
   ※バッチサイズを16行ごとにしているので行数指定の際は最低16行、それ以上は16の倍数で指定するのがおすすめです。

　　
## layout mode
  temlates\Driver'sLisence_MockTest.xslx
　と同じレイアウトになるように調整します、翻訳実行後はすべてのレイアウトが解除されているので、これを実行して整えます
　プルダウンメニューでallを選んだ場合は翻訳とレイアウト調整をセットで実行します。

## check mode
   LaBSEを使用して翻訳精度のチェックを行います。
   意味の一致度が 75% を下回るセルは 赤字 で出力されます。これらは手動での修正（LLMへの再依頼など）を推奨します。


#--Thai-----------------------------------------------------------------------------------------------------------------------------------
## ภาพรวม
   เครื่องมือนี้ใช้สำหรับแปลข้อสอบใบขับขี่ของญี่ปุ่นเป็นภาษาต่างประเทศ (ปัจจุบันรองรับเฉพาะภาษาไทย) โดยอัตโนมัติโดยใช้ NLLB
   
   หลังจากแปลแล้ว สามารถตรวจสอบความถูกต้องของการแปลได้โดยใช้ LaBSE
   
   > [!IMPORTANT]
   > **เกี่ยวกับข้อมูลต้นฉบับ**
   > เพื่อป้องกันลิขสิทธิ์ ข้อมูลคำถามภาษาญี่ปุ่นต้นฉบับจะไม่ถูกรวมอยู่ในเครื่องมือนี้ กรุณาเตรียมไฟล์ Excel ของคุณเองและวางไว้ในตำแหน่งที่กำหนด
   
   เครื่องมือนี้จะดาวน์โหลด AI สำหรับการแปลจาก HuggingFace มายังเครื่องของคุณเพื่อประมวลผล
   ดังนั้นจึงแนะนำให้ใช้ PC ที่มีการ์ดจอ (GPU) ที่รองรับ PyTorch เช่น Nvidia GeForce
   สามารถรันด้วย CPU ได้ แต่การประมวลผลจะช้ามาก
   โมเดล AI จะถูกดาวน์โหลดเมื่อรันครั้งแรก ซึ่งจะใช้เวลานานกว่าปกติ

   ※หมายเหตุเรื่องลิขสิทธิ์:
      โค้ดโปรแกรมของเครื่องมือนี้อยู่ภายใต้ใบอนุญาต MIT แต่สำหรับการใช้โมเดล AI (NLLB-200, LaBSE)
      กรุณาปฏิบัติตามใบอนุญาตของแต่ละโมเดล (Meta, Google)

## สภาพแวดล้อมที่ทดสอบแล้ว
   OS: win32
   Python: 3.12.0
   PyTorch version: 2.9.1+cu130
   CUDA available: True
   　　　Version: 13.0
   GPU: NVIDIA GeForce RTX 5060
   CustomTkinter version: 5.2.2

## การติดตั้ง (Setup)
   1. โคลนหรือดาวน์โหลด repository นี้
   2. ติดตั้งไลบรารี
      pip install -r requirements.txt

## การเริ่มใช้งาน
   รันไฟล์ Tr_Gui.py

## translate mode (โหมดแปลภาษา)
   ใช้ AI (NLLB ของ META) แปลภาษาญี่ปุ่นเป็นภาษาไทย
   กรุณาจัดเตรียมข้อมูลที่ต้องการแปลตามโครงสร้างดังนี้:

      ตำแหน่งไฟล์: กดปุ่มเลือกไฟล์เพื่อเลือกไฟล์ Excel ที่คุณเตรียมไว้
      หมายเหตุ: (เนื้อหาไฟล์ต้องมีโครงสร้างเซลล์เหมือนกับ templates/Driver'sLicense_MockTest.xlsx
            หากโครงสร้างเปลี่ยนไป โปรแกรมอาจทำงานไม่ถูกต้อง)

      คอลัมน์ B: คำถาม (ภาษาญี่ปุ่น)
      คอลัมน์ F: คำอธิบาย (ภาษาญี่ปุ่น)

   ※บรรทัดที่ 1 ถือเป็นส่วนหัว (Header) และจะเริ่มอ่านข้อมูลจากบรรทัดที่ 2
     
   สามารถเลือกแปลเฉพาะคำถาม เฉพาะคำอธิบาย หรือทั้งสองอย่างได้ และสามารถแปลทั้งหมดทีเดียวหรือระบุจำนวนบรรทัดได้
   ※ขนาด Batch คือ 16 บรรทัด ดังนั้นแนะนำให้ระบุจำนวนบรรทัดเป็นพหุคูณของ 16 (เช่น 16, 32, ...)

## layout mode (โหมดจัดรูปแบบ)
   ปรับรูปแบบให้เหมือนกับ templates\Driver'sLisence_MockTest.xslx
   เนื่องจากการแปลจะทำให้รูปแบบเซลล์หายไป โหมดนี้จะช่วยจัดระเบียบใหม่
   หากเลือก "all" ในเมนู โปรแกรมจะทำการแปลและจัดรูปแบบให้พร้อมกัน

## check mode (โหมดตรวจสอบ)
   ใช้ LaBSE เพื่อตรวจสอบความแม่นยำของการแปล
   เซลล์ที่มีความหมายตรงกันต่ำกว่า 75% จะแสดงเป็น ตัวอักษรสีแดง แนะนำให้แก้ไขด้วยตนเอง (หรือใช้ LLM ช่วยแปลใหม่)


#--English--------------------------------------------------------------------------------------------------------------------------------
## Overview
   This is a tool to automatically translate Japanese driver's license written test practice questions into foreign languages (currently only Thai) using NLLB.
   
   After translation, you can check the translation accuracy using LaBSE.
   
   > [!IMPORTANT]
   > **About Source Data**
   > From a copyright protection perspective, the original Japanese question data is NOT included. Please prepare your own Excel file and place it in the specified location.
   
   This tool downloads translation AI models from HuggingFace to your local environment.
   Therefore, it is premised on using a PC equipped with a GPU compatible with PyTorch, such as Nvidia GeForce.
   Execution on CPU only is possible, but processing speed will be significantly slower.
   Note that local AI models are downloaded upon the first execution after library installation, so the first run will take longer than subsequent ones.

   ※License Note:
      The program code of this tool is under the MIT License, but regarding the use of AI models (NLLB-200, LaBSE),
      please follow the licenses of each model (Meta, Google).

## Setup
   1. Clone or download this repository.
   2. Install libraries
      pip install -r requirements.txt

## Launch
   Run Tr_Gui.py

## translate mode
   Translates from Japanese to Thai using AI (Meta's NLLB).
   Please arrange the data you want to translate in the following configuration:
      Location: Click the file selection button to choose your prepared Excel file.
      Column B: Question (Japanese)
      Column F: Explanation (Japanese)

## layout mode
   Adjusts the layout to match templates\Driver'sLisence_MockTest.xslx.

## check mode
   Checks translation accuracy using LaBSE.
   Cells where the semantic match is below 75% are output in Red text. Manual correction is recommended for these.
